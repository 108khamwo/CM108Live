<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <title>CM108 MCR SWITCHER</title>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root { --red: #ff3b30; --bg: #000; }
        body, html { margin: 0; padding: 0; height: 100vh; background: var(--bg); color: white; font-family: 'Sarabun', sans-serif; overflow: hidden; }
        .layout { display: grid; grid-template-rows: 50px 1fr 70px; height: 100vh; }
        
        header { background: #111; border-bottom: 1px solid #333; display: flex; align-items: center; justify-content: space-between; padding: 0 20px; }
        .logo { font-size: 18px; font-weight: bold; color: var(--red); }
        
        main { background: #000; overflow: hidden; }
        iframe { width: 100%; height: 100%; border: none; }

        footer { background: #1a1a1a; border-top: 1px solid #444; display: flex; align-items: center; gap: 15px; padding: 0 20px; }
        .target { background: #333; color: white; border: 1px solid #555; padding: 10px; border-radius: 8px; font-family: 'Sarabun'; }
        .input-box { flex-grow: 1; background: #000; border: 1px solid var(--red); color: #fff; padding: 12px 15px; border-radius: 8px; font-size: 16px; font-family: 'Sarabun'; }
    </style>
</head>
<body>

<div class="layout">
    <header>
        <div class="logo">CM108 <span>MCR v7.0</span></div>
        <div style="font-size: 12px; color: #888;">ห้องคุมสัญญาณ: CM108_NewsRoom</div>
    </header>

    <main>
        <iframe id="mcr" allow="camera;microphone;fullscreen;display-capture;autoplay" 
                src="https://vdo.ninja/?director=CM108_NewsRoom&quality=0&noheader=1&hidelinks=1&hideheader=1"></iframe>
    </main>

    <footer>
        <select id="camTarget" class="target">
            <option value="all">ส่งหาทุกคน</option>
            <option value="CM108_Cam1">กล้อง 1</option>
            <option value="CM108_Cam2">กล้อง 2</option>
            <option value="CM108_Cam3">กล้อง 3</option>
            <option value="CM108_Cam4">กล้อง 4</option>
        </select>
        <input type="text" id="chatMsg" class="input-box" placeholder="พิมพ์ข้อความที่นี่แล้วกด Enter เพื่อส่งด่วน..." onkeydown="if(event.key === 'Enter') doSend()">
    </footer>
</div>

<script>
    function doSend() {
        const msg = document.getElementById('chatMsg').value.trim();
        const target = document.getElementById('camTarget').value;
        const frame = document.getElementById('mcr').contentWindow;

        if (!msg) return;

        // รูปแบบ Payload ที่ VDO.Ninja รองรับเพื่อเด้งขึ้นหน้าจอกล้อง
        const data = { "msg": "chat", "content": msg };
        if (target !== 'all') data.to = target;

        frame.postMessage(data, '*');
        
        document.getElementById('chatMsg').value = ''; // ล้างช่องพิมพ์
    }
</script>

</body>
</html>
