<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>CM108 Digital Zoom Unit</title>
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;500;700&display=swap" rel="stylesheet">
    <style>
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body, html { margin: 0; padding: 0; width: 100%; height: 100dvh; background: #000; font-family: 'Prompt', sans-serif; overflow: hidden; }

        /* --- LOBBY --- */
        #lobby { position: absolute; inset: 0; z-index: 100; background: #111; display: flex; flex-direction: column; padding: 20px; text-align: center; }
        h1 { color: #ff3b30; margin-bottom: 20px; }
        .label { color: #666; font-size: 13px; margin: 15px 0 10px; border-bottom: 1px solid #333; padding-bottom: 5px; text-align: left; }
        
        .mode-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px; }
        .m-btn { background: #1a1a1a; border: 1px solid #333; border-radius: 12px; padding: 15px 5px; color: #888; cursor: pointer; }
        .m-btn.active { background: #ff3b30; color: white; }
        
        .cam-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .c-card { background: #222; border: 1px solid #333; border-radius: 12px; padding: 20px 0; cursor: pointer; color: white; }

        /* --- LIVE VIEW --- */
        #live-view { display: none; position: fixed; inset: 0; background: #000; z-index: 50; }
        iframe { width: 100%; height: 100%; border: none; }

        /* --- ZOOM & CONTROL (‡∏Ç‡∏ß‡∏≤‡∏Å‡∏•‡∏≤‡∏á) --- */
        .side-ctrl {
            position: absolute; right: 15px; top: 45%; transform: translateY(-50%);
            display: flex; flex-direction: column; gap: 20px; align-items: center;
            background: rgba(0,0,0,0.6); padding: 20px 10px; border-radius: 35px;
            backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.1);
            z-index: 60; pointer-events: auto;
        }

        .zoom-slider-box { height: 150px; display: flex; flex-direction: column; align-items: center; gap: 10px; }
        input[type=range][orient=vertical] {
            writing-mode: bt-lr; -webkit-appearance: slider-vertical;
            width: 10px; height: 100%; accent-color: #ff3b30;
        }

        .btn-act { width: 45px; height: 45px; border-radius: 50%; border: none; background: rgba(255,255,255,0.15); color: white; font-size: 20px; cursor: pointer; }
        .btn-home { background: #ff3b30; font-size: 12px; font-weight: bold; }

        /* Black Screen */
        #ghost { position: fixed; inset: 0; background: #000; z-index: 999; display: none; align-items: center; justify-content: center; color: #444; }
    </style>
</head>
<body>

    <div id="lobby">
        <h1>CM108 LIVE</h1>
        <div class="label">1. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏´‡∏°‡∏î‡∏ä‡∏±‡∏î</div>
        <div class="mode-grid">
            <div class="m-btn active" id="m-hq" onclick="setMode('hq')">‡∏ä‡∏±‡∏î‡∏û‡∏¥‡πÄ‡∏®‡∏©</div>
            <div class="m-btn" id="m-safe" onclick="setMode('safe')">‡πÄ‡∏ô‡πâ‡∏ô‡πÄ‡∏™‡∏ñ‡∏µ‡∏¢‡∏£</div>
            <div class="m-btn" id="m-auto" onclick="setMode('auto')">‡∏≠‡∏≠‡πÇ‡∏ï‡πâ</div>
        </div>
        <div class="label">2. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡πà‡∏≠‡∏á‡∏Å‡∏•‡πâ‡∏≠‡∏á</div>
        <div class="cam-grid">
            <div class="c-card" onclick="start('CM108_Cam1')">CAM 01</div>
            <div class="c-card" onclick="start('CM108_Cam2')">CAM 02</div>
            <div class="c-card" onclick="start('CM108_Cam3')">CAM 03</div>
            <div class="c-card" onclick="start('CM108_Cam4')">CAM 04</div>
        </div>
    </div>

    <div id="live-view">
        <iframe id="vid" allow="camera;microphone;fullscreen;display-capture;autoplay"></iframe>

        <div class="side-ctrl">
            <div class="zoom-slider-box">
                <span style="color:#ff3b30; font-weight:bold; font-size:12px;">ZOOM</span>
                <input type="range" orient="vertical" min="100" max="400" step="1" value="100" oninput="digitalZoom(this.value)">
            </div>
            <button class="btn-act" onclick="toggleGhost()">üåô</button>
            <button class="btn-act btn-home" onclick="location.reload()">HOME</button>
        </div>
    </div>

    <div id="ghost" onclick="toggleGhost()"><h2>‡∏û‡∏±‡∏Å‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ (‡∏¢‡∏±‡∏á‡∏™‡πà‡∏á‡∏†‡∏≤‡∏û‡∏≠‡∏¢‡∏π‡πà)</h2></div>

    <script>
        let mode = 'hq';
        function setMode(m) {
            mode = m;
            document.querySelectorAll('.m-btn').forEach(b => b.classList.remove('active'));
            document.getElementById('m-' + m).classList.add('active');
        }

        function start(id) {
            let p = "";
            if(mode === 'hq') p = "&width=1920&height=1080&videobitrate=8000&framerate=60";
            else if(mode === 'safe') p = "&width=1280&height=720&bitrate=2500&framerate=30";
            else p = "&quality=1";

            // ‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô Ninja 100% (&clean=0)
            let url = "https://vdo.ninja/?push=" + id + "&room=CM108_NewsRoom" + p + 
                      "&clean=0&viewchat=1&api=1&label=" + id + "&select";

            document.getElementById('vid').src = url;
            document.getElementById('lobby').style.display = 'none';
            document.getElementById('live-view').style.display = 'block';
        }

        // ‡∏£‡∏∞‡∏ö‡∏ö Digital Zoom ‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡∏ú‡∏•‡∏ï‡πà‡∏≠‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡πÑ‡∏õ (Output)
        function digitalZoom(val) {
            // ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ã‡∏π‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏Ç‡∏≠‡∏á VDO.Ninja
            // ‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏Ñ‡∏∑‡∏≠‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå (100 = ‡∏õ‡∏Å‡∏ï‡∏¥, 400 = ‡∏ã‡∏π‡∏° 4 ‡πÄ‡∏ó‡πà‡∏≤)
            document.getElementById('vid').contentWindow.postMessage({
                "function": "call",
                "target": "video",
                "method": "setZoom",
                "value": val
            }, '*');
            
            // ‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡πÄ‡∏™‡∏£‡∏¥‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ Dashboard ‡∏ã‡∏π‡∏°‡∏ï‡∏≤‡∏°‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
            document.getElementById('vid').contentWindow.postMessage({
                "target": "video",
                "type": "zoom",
                "value": val/100
            }, '*');
        }

        function toggleGhost() {
            let g = document.getElementById('ghost');
            g.style.display = (g.style.display === 'flex') ? 'none' : 'flex';
        }
    </script>
</body>
</html>
