<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>CM108 Mobile Unit</title>
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;500;700&display=swap" rel="stylesheet">
    <style>
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; background: #000; overflow: hidden; font-family: 'Prompt', sans-serif; }

        /* --- 1. ‡∏´‡∏ô‡πâ‡∏≤ Lobby (‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏•‡∏±‡∏Å) --- */
        #lobby { 
            position: absolute; inset: 0; z-index: 100; background: #111; 
            display: flex; flex-direction: column; padding: 20px; overflow-y: auto;
        }
        
        h1 { color: #ff3b30; text-align: center; margin-bottom: 5px; font-size: 24px; }
        .subtitle { color: #666; text-align: center; font-size: 12px; margin-bottom: 25px; }

        .section-label { color: #aaa; font-size: 14px; margin-bottom: 10px; border-bottom: 1px solid #333; padding-bottom: 5px; }

        /* ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏´‡∏°‡∏î 3 ‡πÅ‡∏ö‡∏ö */
        .mode-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-bottom: 25px; }
        .mode-card { 
            background: #222; border: 1px solid #444; border-radius: 10px; padding: 15px 5px; 
            text-align: center; cursor: pointer; transition: 0.2s;
        }
        .mode-card.active { background: #ff3b30; border-color: #ff3b30; color: white; box-shadow: 0 0 10px rgba(255,59,48,0.4); }
        .mode-icon { font-size: 24px; display: block; margin-bottom: 5px; }
        .mode-name { font-size: 12px; font-weight: bold; }

        /* ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏•‡πâ‡∏≠‡∏á 4 ‡∏ï‡∏±‡∏ß */
        .cam-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 30px; }
        .cam-btn { 
            background: #1a1a1a; border: 1px solid #333; color: white; padding: 20px 0; 
            border-radius: 10px; font-size: 18px; cursor: pointer; transition: 0.2s;
        }
        .cam-btn:active { transform: scale(0.95); border-color: #ff3b30; }

        /* --- 2. ‡∏´‡∏ô‡πâ‡∏≤‡∏ñ‡πà‡∏≤‡∏¢‡∏ó‡∏≠‡∏î‡∏™‡∏î --- */
        #live-container { display: none; position: fixed; inset: 0; background: #000; z-index: 50; }
        iframe { width: 100%; height: 100%; border: none; }

        /* ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏°‡∏ô‡∏π‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô (‡∏•‡∏≠‡∏¢‡∏≠‡∏¢‡∏π‡πà‡∏°‡∏∏‡∏°‡∏Ç‡∏ß‡∏≤‡∏ö‡∏ô) */
        .exit-btn {
            position: absolute; top: 15px; right: 15px; z-index: 1000;
            background: rgba(255, 0, 0, 0.7); color: white; border: none;
            padding: 8px 15px; border-radius: 20px; font-size: 12px; font-weight: bold;
            backdrop-filter: blur(5px); cursor: pointer;
        }

        /* ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô (Popup Overlay) */
        #msg-popup {
            position: absolute; top: 40%; left: 50%; transform: translate(-50%, -50%);
            width: 80%; max-width: 400px;
            background: rgba(0, 0, 0, 0.9); border-left: 5px solid #ff3b30;
            color: white; padding: 20px; border-radius: 8px; text-align: center;
            display: none; z-index: 2000; box-shadow: 0 10px 30px rgba(0,0,0,0.8);
            pointer-events: none; /* ‡πÉ‡∏´‡πâ‡∏à‡∏¥‡πâ‡∏°‡∏ó‡∏∞‡∏•‡∏∏‡πÑ‡∏î‡πâ */
        }
    </style>
</head>
<body>

    <div id="lobby">
        <h1>CM108 LIVE</h1>
        <div class="subtitle">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏´‡∏°‡∏î‡πÅ‡∏•‡∏∞‡∏ä‡πà‡∏≠‡∏á‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì</div>

        <div class="section-label">1. ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏±‡∏î/‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏ñ‡∏µ‡∏¢‡∏£</div>
        <div class="mode-grid">
            <div class="mode-card active" id="mode-hq" onclick="setMode('hq')">
                <span class="mode-icon">üíé</span>
                <span class="mode-name">‡∏ä‡∏±‡∏î‡∏™‡∏∏‡∏î<br>(HQ)</span>
            </div>
            <div class="mode-card" id="mode-stable" onclick="setMode('stable')">
                <span class="mode-icon">üõ°Ô∏è</span>
                <span class="mode-name">‡πÄ‡∏™‡∏ñ‡∏µ‡∏¢‡∏£<br>(Safe)</span>
            </div>
            <div class="mode-card" id="mode-auto" onclick="setMode('auto')">
                <span class="mode-icon">ü§ñ</span>
                <span class="mode-name">‡∏≠‡∏≠‡πÇ‡∏ï‡πâ<br>(Auto)</span>
            </div>
        </div>

        <div class="section-label">2. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡πà‡∏≠‡∏á‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì</div>
        <div class="cam-grid">
            <button class="cam-btn" onclick="start('CM108_Cam1')">‡∏Å‡∏•‡πâ‡∏≠‡∏á 1</button>
            <button class="cam-btn" onclick="start('CM108_Cam2')">‡∏Å‡∏•‡πâ‡∏≠‡∏á 2</button>
            <button class="cam-btn" onclick="start('CM108_Cam3')">‡∏Å‡∏•‡πâ‡∏≠‡∏á 3</button>
            <button class="cam-btn" onclick="start('CM108_Cam4')">‡∏Å‡∏•‡πâ‡∏≠‡∏á 4</button>
        </div>
        
        <p style="color:#666; font-size:12px; text-align:center;">
            * ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Å‡∏î‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏•‡πâ‡∏≠‡∏á ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÄ‡∏î‡πâ‡∏á‡∏ñ‡∏≤‡∏°‡πÉ‡∏´‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏•‡∏ô‡∏™‡πå (‡∏´‡∏•‡∏±‡∏á/‡∏Å‡∏ß‡πâ‡∏≤‡∏á) ‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á
        </p>
    </div>

    <div id="live-container">
        <button class="exit-btn" onclick="location.reload()">‚èπ ‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏•‡∏±‡∏Å</button>
        
        <div id="msg-popup">
            <div style="font-size:12px; color:#aaa; margin-bottom:5px;">‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏à‡∏≤‡∏Å‡∏®‡∏π‡∏ô‡∏¢‡πå:</div>
            <span id="msg-text" style="font-size:20px; font-weight:bold;">--</span>
        </div>

        <iframe id="vid" allow="camera;microphone;fullscreen;display-capture;autoplay"></iframe>
    </div>

    <script>
        let currentMode = 'hq';

        function setMode(m) {
            currentMode = m;
            document.querySelectorAll('.mode-card').forEach(el => el.classList.remove('active'));
            document.getElementById('mode-' + m).classList.add('active');
        }

        function start(camId) {
            // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ URL Parameters ‡∏ï‡∏≤‡∏°‡πÇ‡∏´‡∏°‡∏î
            let params = "";
            if (currentMode === 'hq') {
                // ‡πÇ‡∏´‡∏°‡∏î‡∏ä‡∏±‡∏î: 1080p, 60fps, 8Mbps
                params = "&width=1920&height=1080&videobitrate=8000&framerate=60&quality=0";
            } else if (currentMode === 'stable') {
                // ‡πÇ‡∏´‡∏°‡∏î‡πÄ‡∏™‡∏ñ‡∏µ‡∏¢‡∏£: 720p, 30fps, Buffer ‡πÄ‡∏¢‡∏≠‡∏∞‡∏´‡∏ô‡πà‡∏≠‡∏¢
                params = "&width=1280&height=720&bitrate=2500&framerate=30&buffer=2000&quality=1";
            } else {
                // ‡πÇ‡∏´‡∏°‡∏î‡∏≠‡∏≠‡πÇ‡∏ï‡πâ: ‡πÉ‡∏´‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏≠‡∏á
                params = "&quality=1&meshcast";
            }

            // URL ‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢:
            // &clean=0 : ‡πÑ‡∏°‡πà‡∏•‡∏ö‡∏õ‡∏∏‡πà‡∏°! (‡πÉ‡∏ä‡πâ‡∏õ‡∏∏‡πà‡∏° Ninja ‡πÅ‡∏ó‡πâ‡πÜ)
            // &transparent=0 : ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏ó‡∏∂‡∏ö
            // &chat=0 : ‡∏õ‡∏¥‡∏î‡πÅ‡∏ä‡∏ó‡πÄ‡∏î‡∏¥‡∏°‡∏Ç‡∏≠‡∏á Ninja (‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÉ‡∏ä‡πâ Popup ‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤‡πÄ‡∏≠‡∏á)
            // &select : ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏ñ‡∏≤‡∏°‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏•‡∏ô‡∏™‡πå‡∏Å‡∏•‡πâ‡∏≠‡∏á
            let url = "https://vdo.ninja/?push=" + camId + "&room=CM108_NewsRoom" + params + 
                      "&clean=0&transparent=0&select&autostart&label=" + camId;

            document.getElementById('vid').src = url;
            document.getElementById('lobby').style.display = 'none';
            document.getElementById('live-container').style.display = 'block';

            // ‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏î‡∏±‡∏Å‡∏à‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° (Chat Listener)
            // ‡πÅ‡∏°‡πâ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡∏õ‡∏∏‡πà‡∏° Ninja ‡πÅ‡∏ï‡πà‡πÄ‡∏£‡∏≤‡∏¢‡∏±‡∏á‡∏î‡∏±‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏ä‡∏ó‡∏°‡∏≤‡πÅ‡∏™‡∏î‡∏á‡∏ö‡∏ô Popup ‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤‡πÑ‡∏î‡πâ
            window.addEventListener('message', function(e) {
                if (e.data.msg === 'chat' || e.data.action === 'chat') {
                    let text = e.data.content || e.data.value;
                    showPopup(text);
                }
            });
        }

        function showPopup(text) {
            let p = document.getElementById('msg-popup');
            document.getElementById('msg-text').innerText = text;
            p.style.display = 'block';
            
            // ‡∏™‡∏±‡πà‡∏ô‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô (‡∏ñ‡πâ‡∏≤‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö)
            if (navigator.vibrate) navigator.vibrate(200);

            // ‡∏ã‡πà‡∏≠‡∏ô‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏´‡∏•‡∏±‡∏á 10 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
            setTimeout(() => { p.style.display = 'none'; }, 10000);
        }
    </script>
</body>
</html>
